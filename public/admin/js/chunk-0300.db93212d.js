(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0300"],{2423:function(t,e,a){"use strict";a.d(e,"d",function(){return n}),a.d(e,"c",function(){return r}),a.d(e,"b",function(){return o}),a.d(e,"a",function(){return s}),a.d(e,"e",function(){return c});var i=a("b775");function n(t){return Object(i["a"])({url:"/articles",method:"post",data:t})}function r(t){return Object(i["a"])({url:"/articles/"+t,method:"get"})}function o(t){return Object(i["a"])({url:"/articles",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/articles/"+t,method:"post",data:{_method:"DELETE"}})}function c(t,e){return e["_method"]="PUT",Object(i["a"])({url:"/articles/"+t,method:"post",data:e})}},2431:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{"label-position":"right","label-width":"80px",model:t.article}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{staticStyle:{width:"450px"},attrs:{size:"small"},model:{value:t.article.title,callback:function(e){t.$set(t.article,"title",e)},expression:"article.title"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"/api/admin/images",name:"image",headers:t.uploadHeaders,"show-file-list":!1,"auto-upload":!0,"on-success":t.handleUploadSuccess,"before-upload":t.beforeUpload}},[t.article.cover_img?a("img",{staticClass:"avatar",attrs:{src:t.article.cover_img}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"正文"}},[a("mavon-editor",{ref:"md",staticStyle:{height:"600px"},attrs:{"code-style":"googlecode",toolbars:t.toolbars},on:{imgAdd:t.imgAdd},model:{value:t.article.markdown,callback:function(e){t.$set(t.article,"markdown",e)},expression:"article.markdown"}})],1),a("el-form-item",{attrs:{label:"标签"}},[t._l(t.article.tags,function(e){return a("el-tag",{key:e,staticStyle:{"margin-right":"10px"},attrs:{size:"normal",closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n      "+t._s(e)+"\n    ")])}),t.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue="string"===typeof e?e.trim():e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 新增标签")])],2),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择分类"},model:{value:t.article.category_id,callback:function(e){t.$set(t.article,"category_id",e)},expression:"article.category_id"}},t._l(t.categories,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1),a("el-form-item",[0===t.article.id?a("el-button",{attrs:{size:"small",type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("确认发布")]):a("el-button",{attrs:{size:"small",type:"primary",loading:t.loading},on:{click:t.onUpdate}},[t._v("确认修改")])],1)],1)},n=[],r=(a("6762a"),a("2fdb"),a("b2d8")),o=(a("64e1"),a("91b6")),s=a("c405"),c=a("2423"),l=a("5f87"),u={name:"ArticleAdd",components:{mavonEditor:r["mavonEditor"]},data:function(){return{inputVisible:!1,inputValue:"",value:"",imageUrl:"",article:{title:"",category_id:"",markdown:"",tags:[],cover_img:"",id:0},loading:!1,categories:[],toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0},editor:{},uploadHeaders:{}}},methods:{handleClose:function(t){this.article.tags.splice(this.article.tags.indexOf(t),1)},showInput:function(){var t=this;this.article.tags.length>=5?this.$message.warning("标签最多添加5个"):(this.inputVisible=!0,this.$nextTick(function(){t.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){if(this.article.tags.includes(this.inputValue))this.$message.warning("当前标签已添加");else{var t=this.inputValue;t&&this.article.tags.push(t),this.inputVisible=!1,this.inputValue=""}},imgAdd:function(t,e){var a=this,i=new FormData;i.append("image",e),Object(o["a"])(i).then(function(e){"2000"===e.data.code&&a.$refs.md.$img2Url(t,e.data.data.basePath)})},getCategories:function(){var t=this;Object(s["b"])().then(function(e){t.categories=e.data.data})},onSubmit:function(){var t=this;Object(c["d"])(this.article).then(function(){t.$notify({title:"成功",message:"文章添加成功",type:"success",duration:2e3}),t.$router.push("/articles")})},onUpdate:function(){var t=this;Object(c["e"])(this.article.id,this.article).then(function(){t.$notify({title:"成功",message:"文章修改成功",type:"success",duration:2e3}),t.$router.push("/articles")})},getArticle:function(){var t=this;this.$route.params.id>0?Object(c["c"])(this.$route.params.id).then(function(e){for(var a in t.article=e.data.data,t.article.category_id=e.data.data.category_id,t.article.tags)t.article.tags[a]=t.article.tags[a].title;t.getCategories()}):this.getCategories()},beforeUpload:function(t){var e=t.size/1024/1024<4;return e||this.$message.error("上传头像图片大小不能超过 4MB!"),e},handleUploadSuccess:function(t){"2000"===t.code?this.article.cover_img=t.data.basePath:this.$message.error("封面图片上传失败。")},setUploadHeaders:function(){this.uploadHeaders={Accept:"application/json","X-Requested-With":"XMLHttpRequest",Authorization:"Bearer "+Object(l["b"])()}}},watch:{$route:function(){this.article={}}},mounted:function(){this.getArticle(),this.setUploadHeaders()}},d=u,f=(a("c16b"),a("2877")),p=Object(f["a"])(d,i,n,!1,null,"16f719ea",null);p.options.__file="ArticleAdd.vue";e["default"]=p.exports},"2fdb":function(t,e,a){"use strict";var i=a("5ca1"),n=a("d2c8"),r="includes";i(i.P+i.F*a("5147")(r),"String",{includes:function(t){return!!~n(this,t,r).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},5147:function(t,e,a){var i=a("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},"6762a":function(t,e,a){"use strict";var i=a("5ca1"),n=a("c366")(!0);i(i.P,"Array",{includes:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")},"9c5d":function(t,e,a){},aae3:function(t,e,a){var i=a("d3f4"),n=a("2d95"),r=a("2b4c")("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==n(t))}},c16b:function(t,e,a){"use strict";var i=a("9c5d"),n=a.n(i);n.a},c405:function(t,e,a){"use strict";a.d(e,"b",function(){return n}),a.d(e,"c",function(){return r}),a.d(e,"d",function(){return o}),a.d(e,"a",function(){return s});var i=a("b775");function n(){return Object(i["a"])({url:"/categories",method:"get"})}function r(t){return Object(i["a"])({url:"/categories",method:"post",data:t})}function o(t,e){return t["_method"]="PUT",Object(i["a"])({url:"/categories/"+e,method:"post",data:t})}function s(t){return Object(i["a"])({url:"/categories/"+t,method:"post",data:{_method:"DELETE"}})}},d2c8:function(t,e,a){var i=a("aae3"),n=a("be13");t.exports=function(t,e,a){if(i(e))throw TypeError("String#"+a+" doesn't accept regex!");return String(n(t))}}}]);
//# sourceMappingURL=chunk-0300.db93212d.js.map